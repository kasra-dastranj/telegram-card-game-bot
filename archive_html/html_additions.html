<!-- این بخش باید به card_management.html اضافه شود -->
<!-- در بخش state ها (بعد از const [stickerBadge, setStickerBadge] = useState(false);) -->

const [gameSettings, setGameSettings] = useState(null);
const [settingsLoading, setSettingsLoading] = useState(false);

<!-- در بخش useEffect (بعد از loadStats();) -->

loadGameSettings();

<!-- توابع جدید (قبل از return) -->

const loadGameSettings = async () => {
    try {
        const response = await fetch('/api/game-settings');
        const data = await response.json();
        if (data.success) {
            setGameSettings(data.settings);
        }
    } catch (error) {
        console.error('خطا در بارگیری تنظیمات:', error);
    }
};

const updateHeartSettings = async (dailyHearts) => {
    setSettingsLoading(true);
    try {
        const response = await fetch('/api/game-settings/hearts', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ daily_hearts: parseInt(dailyHearts) })
        });
        const data = await response.json();
        if (data.success) {
            alert('✅ ' + data.message);
            loadGameSettings();
        } else {
            alert('❌ ' + data.error);
        }
    } catch (error) {
        alert('❌ خطا در ارتباط');
    }
    setSettingsLoading(false);
};

const updateCooldownSettings = async (settings) => {
    setSettingsLoading(true);
    try {
        const response = await fetch('/api/game-settings/cooldown', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(settings)
        });
        const data = await response.json();
        if (data.success) {
            alert('✅ ' + data.message);
            loadGameSettings();
        } else {
            alert('❌ ' + data.error);
        }
    } catch (error) {
        alert('❌ خطا در ارتباط');
    }
    setSettingsLoading(false);
};

const resetAllCooldowns = async () => {
    if (!confirm('آیا مطمئن هستید که می‌خواهید همه Cooldown ها را ریست کنید؟')) return;
    
    setSettingsLoading(true);
    try {
        const response = await fetch('/api/cooldown/reset', { method: 'POST' });
        const data = await response.json();
        if (data.success) {
            alert('✅ ' + data.message);
        } else {
            alert('❌ ' + data.error);
        }
    } catch (error) {
        alert('❌ خطا در ارتباط');
    }
    setSettingsLoading(false);
};

<!-- کامپوننت تنظیمات (قبل از return اصلی) -->

const GameSettingsPanel = () => {
    if (!gameSettings) return <div className="text-center py-4">در حال بارگیری تنظیمات...</div>;
    
    return (
        <div className="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 className="text-xl font-bold mb-4 text-gray-800">⚙️ تنظیمات بازی</h2>
            
            {/* تنظیمات جان‌ها */}
            <div className="mb-6 p-4 border border-gray-200 rounded-lg">
                <h3 className="text-lg font-semibold mb-3 text-red-600">❤️ تنظیمات جان‌ها</h3>
                <div className="flex items-center gap-4">
                    <label className="font-medium">جان روزانه:</label>
                    <input 
                        type="number" 
                        min="1" 
                        max="50" 
                        defaultValue={gameSettings.daily_hearts}
                        className="border border-gray-300 rounded px-3 py-1 w-20"
                        id="dailyHeartsInput"
                    />
                    <button 
                        onClick={() => updateHeartSettings(document.getElementById('dailyHeartsInput').value)}
                        disabled={settingsLoading}
                        className="bg-blue-500 text-white px-4 py-1 rounded hover:bg-blue-600 disabled:opacity-50"
                    >
                        {settingsLoading ? 'در حال بروزرسانی...' : 'بروزرسانی'}
                    </button>
                </div>
                <p className="text-sm text-gray-600 mt-2">
                    فعلی: {gameSettings.daily_hearts} جان • ریست هر {gameSettings.heart_reset_hours} ساعت
                </p>
            </div>
            
            {/* تنظیمات Cooldown */}
            <div className="mb-6 p-4 border border-gray-200 rounded-lg">
                <h3 className="text-lg font-semibold mb-3 text-blue-600">❄️ تنظیمات Cooldown کارت‌ها</h3>
                
                <div className="space-y-3">
                    <div className="flex items-center gap-4">
                        <label className="font-medium">وضعیت:</label>
                        <input 
                            type="checkbox" 
                            defaultChecked={gameSettings.card_cooldown_enabled}
                            className="w-4 h-4"
                            id="cooldownEnabledInput"
                        />
                        <span>{gameSettings.card_cooldown_enabled ? 'فعال' : 'غیرفعال'}</span>
                    </div>
                    
                    <div className="flex items-center gap-4">
                        <label className="font-medium">حد مجاز برد:</label>
                        <input 
                            type="number" 
                            min="1" 
                            max="100" 
                            defaultValue={gameSettings.card_cooldown_win_limit}
                            className="border border-gray-300 rounded px-3 py-1 w-20"
                            id="cooldownWinLimitInput"
                        />
                    </div>
                    
                    <div className="flex items-center gap-4">
                        <label className="font-medium">مدت Cooldown (ساعت):</label>
                        <input 
                            type="number" 
                            min="1" 
                            max="168" 
                            defaultValue={gameSettings.card_cooldown_hours}
                            className="border border-gray-300 rounded px-3 py-1 w-20"
                            id="cooldownHoursInput"
                        />
                    </div>
                    
                    <div className="flex gap-2">
                        <button 
                            onClick={() => updateCooldownSettings({
                                enabled: document.getElementById('cooldownEnabledInput').checked,
                                win_limit: parseInt(document.getElementById('cooldownWinLimitInput').value),
                                cooldown_hours: parseInt(document.getElementById('cooldownHoursInput').value)
                            })}
                            disabled={settingsLoading}
                            className="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 disabled:opacity-50"
                        >
                            {settingsLoading ? 'در حال بروزرسانی...' : 'بروزرسانی تنظیمات'}
                        </button>
                        
                        <button 
                            onClick={resetAllCooldowns}
                            disabled={settingsLoading}
                            className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 disabled:opacity-50"
                        >
                            ریست همه Cooldown ها
                        </button>
                    </div>
                </div>
                
                <p className="text-sm text-gray-600 mt-2">
                    کارت‌های Epic و Legend پس از {gameSettings.card_cooldown_win_limit} برد وارد Cooldown می‌شوند
                </p>
            </div>
        </div>
    );
};

<!-- در return اصلی، بعد از <div className="container mx-auto px-4 py-8"> -->

<GameSettingsPanel />